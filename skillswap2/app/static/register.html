<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SkillSwap Registration</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
    background:linear-gradient(135deg,#6b6bd6,#8a6cd9);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
}

.card{
    width:450px;
    padding:30px;
    border-radius:18px;
    box-shadow:0 20px 40px rgba(0,0,0,.2);
}

.role-btn{
    width:48%;
}

.role-btn.active{
    background:#2563eb;
    color:white;
}
</style>
</head>

<body>

<div class="card">

<h3 class="text-center fw-bold mb-3">SkillSwap Registration</h3>

<div class="d-flex gap-2 mb-3">
    <button type="button" id="mentorBtn" class="btn btn-outline-primary role-btn active">üë®‚Äçüè´ Mentor</button>
    <button type="button" id="learnerBtn" class="btn btn-outline-secondary role-btn">üéì Learner</button>
</div>

<form id="registerForm">

<input id="email" class="form-control mb-2" placeholder="Email" required>
<input id="password" type="password" class="form-control mb-2" placeholder="Password" required>
<input id="name" class="form-control mb-2" placeholder="Full Name" required>

<!-- Mentor Fields -->
<div id="mentorFields">
    <input id="qualification" class="form-control mb-2" placeholder="Qualification">
    <input id="linkedin" class="form-control mb-2" placeholder="LinkedIn Profile URL">
</div>

<!-- Learner Fields -->
<div id="learnerFields" style="display:none;">
    <input id="phone" class="form-control mb-2" placeholder="Phone Number">
    <input id="studying" class="form-control mb-2" placeholder="Where are you studying?">
    <textarea id="bio" class="form-control mb-2" placeholder="Short Bio"></textarea>
</div>

<button class="btn btn-primary w-100 mt-2">Create Account</button>

</form>

<p class="text-center mt-3">
<a href="/login">Already have an account? Login</a>
</p>

</div>

<script>
let role = "mentor"

const mentorBtn = document.getElementById("mentorBtn")
const learnerBtn = document.getElementById("learnerBtn")

const mentorFields = document.getElementById("mentorFields")
const learnerFields = document.getElementById("learnerFields")

mentorBtn.onclick = () => {
    role = "mentor"
    mentorBtn.classList.add("active")
    learnerBtn.classList.remove("active")
    mentorFields.style.display = "block"
    learnerFields.style.display = "none"
}

learnerBtn.onclick = () => {
    role = "learner"
    learnerBtn.classList.add("active")
    mentorBtn.classList.remove("active")
    mentorFields.style.display = "none"
    learnerFields.style.display = "block"
}

document.getElementById("registerForm").addEventListener("submit", async e => {
    e.preventDefault()

    const formData = new FormData()

    formData.append("email", email.value)
    formData.append("password", password.value)
    formData.append("full_name", name.value)
    formData.append("role", role)

    if(role === "mentor"){
        formData.append("qualification", qualification.value)
        formData.append("linkedin", linkedin.value)
    }else{
        formData.append("phone", phone.value)
        formData.append("studying", studying.value)
        formData.append("bio", bio.value)
    }

    try{
        const res = await fetch("http://localhost:8000/auth/register", {
            method: "POST",
            body: formData
        })

        const text = await res.text()

        if(!res.ok){
            alert("Registration failed:\n" + text)
            return
        }

        alert("‚úÖ Registered successfully!")
        window.location.href = "/login"

    }catch(err){
        alert("Network error: " + err)
    }
})
</script>

</body>
</html>
